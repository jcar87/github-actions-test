name: Show macOS SDKs
run-name: List macOS SDKs üöÄ
on: [push]
jobs:
  show-macos-sdks:
    runs-on: macos-latest
    steps:
      - run: echo "üéâ The job was automatically triggered by a ${{ github.event_name }} event."
      - run: echo "üêß This job is now running on a ${{ runner.os }} server hosted by GitHub!"
      - run: echo "üîé The name of your branch is ${{ github.ref }} and your repository is ${{ github.repository }}."
      - name: Check out repository code
        uses: actions/checkout@v3
      - run: echo "üí° The ${{ github.repository }} repository has been cloned to the runner."
      - run: echo "üñ•Ô∏è The workflow is now ready to test your code on the runner."
      - name: List files in /Library/Developer/CommandLineTools/SDKs
        run: |
          echo ls -la /Library/Developer/CommandLineTools/SDKs
          ls -la /Library/Developer/CommandLineTools/SDKs
          echo ls -la /Applications/Xcode_14.0.1.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/
          ls -la /Applications/Xcode_14.0.1.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/
          echo ls -la /Library/Developer/CommandLineTools
          ls -la /Library/Developer/CommandLineTools
      - name: Run xcrun to query default SDK
        run: |
          xcrun --show-sdk-path
          xcrun -sdk macosx --show-sdk-path
          xcrun --show-sdk-platform-version
      - name: Run xcrun with Xcode 14.1
        run: | 
          DEVELOPER_DIR=$XCODE_14_DEVELOPER_DIR xcrun --show-sdk-path
          DEVELOPER_DIR=$XCODE_14_DEVELOPER_DIR xcrun -sdk macosx --show-sdk-path
          DEVELOPER_DIR=$XCODE_14_DEVELOPER_DIR xcrun --show-sdk-platform-version
      - name: Query CLT
        run: |
          DEVELOPER_DIR=/Library/Developer/CommandLineTools xcrun xcrun --show-sdk-path
          DEVELOPER_DIR=/Library/Developer/CommandLineTools xcrun xcrun -sdk -macosx -show-sdk-path
          DEVELOPER_DIR=/Library/Developer/CommandLineTools xcrun xcrun --show-sdk-platform-path
          DEVELOPER_DIR=/Library/Developer/CommandLineTools xcrun xcrun --show-sdk-platform-version
      - name: Show current macOS version
        run: |
          sw_vers
      - name: Print current environment
        run: | 
          printenv
      - name: Build file with Xcode 14.0.1
        run: |
          clang++ hello.cpp -v -o hello
          vtool -show-build hello
      - name: Build file with Xcode 14.1
        run: |
          DEVELOPER_DIR=$XCODE_14_DEVELOPER_DIR clang++ hello.cpp -v -o hello
          vtool -show-build hello

